import{a4 as e,r as t,o as s,c as o,w as a,e as i,B as l,C as n,D as u,E as r,H as c,F as d,p as m,u as h,M as p,z as f,k as v,R as _}from"../vendor.69e0273a.js";import{r as y,_ as g}from"../uni-app.es.3ef08382.js";import{_ as S}from"../uni-easyinput.4180e833.js";import{A as b}from"../api.0a8de5c9.js";const C={name:"UniRate",props:{isFill:{type:[Boolean,String],default:!0},color:{type:String,default:"#ececec"},activeColor:{type:String,default:"#ffca3e"},disabledColor:{type:String,default:"#c0c0c0"},size:{type:[Number,String],default:24},value:{type:[Number,String],default:1},modelValue:{type:[Number,String],default:1},max:{type:[Number,String],default:5},margin:{type:[Number,String],default:0},disabled:{type:[Boolean,String],default:!1},readonly:{type:[Boolean,String],default:!1},allowHalf:{type:[Boolean,String],default:!1},touchable:{type:[Boolean,String],default:!0}},data:()=>({valueSync:"",userMouseFristMove:!0,userRated:!1,userLastRate:1}),watch:{value(e){this.valueSync=Number(e)},modelValue(e){this.valueSync=Number(e)}},computed:{stars(){const e=this.valueSync?this.valueSync:0,t=[],s=Math.floor(e),o=Math.ceil(e);for(let a=0;a<this.max;a++)s>a?t.push({activeWitch:"100%"}):o-1===a?t.push({activeWitch:100*(e-s)+"%"}):t.push({activeWitch:"0"});return t},marginNumber(){return Number(this.margin)}},created(){this.valueSync=Number(this.value||this.modelValue),this._rateBoxLeft=0,this._oldValue=null},mounted(){setTimeout((()=>{this._getSize()}),100),this.PC=this.IsPC()},methods:{touchstart(e){if(this.IsPC())return;if(this.readonly||this.disabled)return;const{clientX:t,screenX:s}=e.changedTouches[0];this._getRateCount(t||s)},touchmove(e){if(this.IsPC())return;if(this.readonly||this.disabled||!this.touchable)return;const{clientX:t,screenX:s}=e.changedTouches[0];this._getRateCount(t||s)},mousedown(e){if(!this.IsPC())return;if(this.readonly||this.disabled)return;const{clientX:t}=e;this.userLastRate=this.valueSync,this._getRateCount(t),this.userRated=!0},mousemove(e){if(!this.IsPC())return;if(this.userRated)return;if(this.userMouseFristMove&&(console.log("---mousemove----",this.valueSync),this.userLastRate=this.valueSync,this.userMouseFristMove=!1),this.readonly||this.disabled||!this.touchable)return;const{clientX:t}=e;this._getRateCount(t)},mouseleave(e){this.IsPC()&&(this.readonly||this.disabled||!this.touchable||(this.userRated?this.userRated=!1:this.valueSync=this.userLastRate))},IsPC(){var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],s=!0;for(let o=0;o<t.length-1;o++)if(e.indexOf(t[o])>0){s=!1;break}return s},_getRateCount(e){this._getSize();const t=Number(this.size);if(NaN===t)return new Error("size 属性只能设置为数字");const s=e-this._rateBoxLeft;let o=parseInt(s/(t+this.marginNumber));o=o<0?0:o,o=o>this.max?this.max:o;const a=parseInt(s-(t+this.marginNumber)*o);let i=0;(this._oldValue!==o||this.PC)&&(this._oldValue=o,i=this.allowHalf?a>t/2?o+1:o+.5:o+1,i=Math.max(.5,Math.min(i,this.max)),this.valueSync=i,this._onChange())},_onChange(){this.$emit("input",this.valueSync),this.$emit("update:modelValue",this.valueSync),this.$emit("change",{value:this.valueSync})},_getSize(){e().in(this).select(".uni-rate").boundingClientRect().exec((e=>{e&&(this._rateBoxLeft=e[0].left)}))}}};C.render=function(e,h,p,f,v,_){const S=y(t("uni-icons"),g),b=m;return s(),o(b,null,{default:a((()=>[i(b,{ref:"uni-rate",class:"uni-rate"},{default:a((()=>[(s(!0),l(d,null,n(_.stars,((e,t)=>(s(),o(b,{class:u(["uni-rate__icon",{"uni-cursor-not-allowed":p.disabled}]),style:r({"margin-right":_.marginNumber+"px"}),key:t,onTouchstart:c(_.touchstart,["stop"]),onTouchmove:c(_.touchmove,["stop"]),onMousedown:c(_.mousedown,["stop"]),onMousemove:c(_.mousemove,["stop"]),onMouseleave:_.mouseleave},{default:a((()=>[i(S,{color:p.color,size:p.size,type:p.isFill?"star-filled":"star"},null,8,["color","size","type"]),i(b,{style:r({width:e.activeWitch}),class:"uni-rate__icon-on"},{default:a((()=>[i(S,{color:p.disabled?p.disabledColor:p.activeColor,size:p.size,type:"star-filled"},null,8,["color","size"])])),_:2},1032,["style"])])),_:2},1032,["class","style","onTouchstart","onTouchmove","onMousedown","onMousemove","onMouseleave"])))),128))])),_:1},512)])),_:1})},C.__scopeId="data-v-6362d4ea";const V={data:()=>({orderId:0,comment_shop:{value:0,comment:""},comment_courier:{value:0,comment:""}}),onLoad(e){this.orderId=e.orderId},methods:{submit:function(){h({method:"POST",url:b+"/TaComment",data:{orderId:this.orderId,score:this.comment_shop.value,content:this.comment_shop.comment,type:"shop"},success:e=>{h({method:"POST",url:b+"/TaComment",data:{orderId:this.orderId,score:this.comment_courier.value,content:this.comment_courier.comment,type:"courier"},success:e=>{p({url:"./Orders"})}})}})}}};V.render=function(e,l,n,u,r,c){const d=y(t("uni-rate"),C),h=y(t("uni-easyinput"),S),p=m,f=_;return s(),o(p,null,{default:a((()=>[i(p,{class:"top_ta"},{default:a((()=>[i(d,{modelValue:r.comment_shop.value,"onUpdate:modelValue":l[0]||(l[0]=e=>r.comment_shop.value=e)},null,8,["modelValue"]),i(h,{modelValue:r.comment_shop.comment,"onUpdate:modelValue":l[1]||(l[1]=e=>r.comment_shop.comment=e),placeholder:"请输入对商店的评论"},null,8,["modelValue"])])),_:1}),i(p,{class:"middle"},{default:a((()=>[i(d,{modelValue:r.comment_courier.value,"onUpdate:modelValue":l[2]||(l[2]=e=>r.comment_courier.value=e)},null,8,["modelValue"]),i(h,{modelValue:r.comment_courier.comment,"onUpdate:modelValue":l[3]||(l[3]=e=>r.comment_courier.comment=e),placeholder:"请输入对送餐员的评论"},null,8,["modelValue"])])),_:1}),i(p,{class:"foot"},{default:a((()=>[i(f,{type:"primary",onClick:c.submit},{default:a((()=>[v("评价")])),_:1},8,["onClick"])])),_:1})])),_:1})},V.__scopeId="data-v-ca969ca4",f(V);export default V;
